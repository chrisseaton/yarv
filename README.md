# YARV

This project's aim is to provide an educational window into how CRuby's virtual machine works under the hood.

CRuby uses a stack-based virtual machine named YARV. You can see the bytecode that will be executed by running `RubyVM::InstructionSequence.compile(source).disasm` or by running `ruby --dump=insns -e source`. At last count, there were `202` instructions, though that number gets significantly smaller if you factor out tracepoint and specialized instructions. Most instructions look similar to their machine code counterparts.

There isn't really a canonical source for documentation for these instructions beyond the source code itself in [insns.def](https://github.com/ruby/ruby/blob/master/insns.def) or the original YARV [design document](http://www.atdot.net/yarv/yarvarch.ja.html). Because of this, this project aims to provide comprehensive documentation to make it easier to contribute to CRuby's development. The documentation is currently published at <https://kddnewton.com/yarv/>. It is generated by running `bin/doc`.

As a part of the documentation effort, this project also aims to provide an emulator of YARV behavior. This will ensure the documentation doesn't get out of date as it will need to reflect actual Ruby semantics. To run the emulator, after cloning the repository, run `exe/yarv <path_to_file>` from the command line.

## Contributing

Bug reports and pull requests are welcome on GitHub at https://github.com/kddnewton/yarv. In this project's current form there are lots of opportunities to contribute. To get started, please check the issues on the project board.

## License

The gem is available as open source under the terms of the [MIT License](https://opensource.org/licenses/MIT).
